# 安全考虑

我们认为内网（服务器）环境相对安全可控，因此并未做太多的安全设计。

但是出于隔离、避免误操作的考虑，我们作了如下设计：

- 客户机（本地的代理守护进程）请求调度器、缓存服务器时需要提供参数`--token`。这将允许我们实现非对称式部署，编译机只提供服务、写入缓存，用户只能提交任务、读取缓存。对于无法识别的`token`，调度器、缓存服务器将会拒绝相应的请求。

- 客户机请求其他编译机时需要提供由调度器分配的`serving_daemon_token`。这个`token`会每隔1小时滚动一次。这个属于程序内部实现，无需从外界传入。

  这儿选择新引入`serving_daemon_token`而不是复用`token`主要考虑到`token`的滚动更新的需求。

- 为了支持滚动更新`token`，调度器、缓存服务器可以接受多个`token`，并随着客户机的升级逐渐淘汰老的`token`。

  我们不支持客户机长期不升级的场景。目前我们通过脚本在每次编译之前检测客户机版本。

  如果没有滚动更新`token`方面的需求，则可以支持客户机长期不升级。（不考虑协议更新的话）
